BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%turquoise%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 260531256.215744
 ALGERIA                   |   1997 | 456691908.791319
 ALGERIA                   |   1996 | 453116855.515723
 ALGERIA                   |   1995 | 446165272.336547
 ALGERIA                   |   1994 | 453379280.632581
 ALGERIA                   |   1993 | 442212542.584331
 ALGERIA                   |   1992 | 448057457.815331
 ARGENTINA                 |   1998 | 267137411.208186
 ARGENTINA                 |   1997 | 459634856.363583
 ARGENTINA                 |   1996 | 470012205.776747
 ARGENTINA                 |   1995 | 474303521.487748
 ARGENTINA                 |   1994 | 468150104.112953
 ARGENTINA                 |   1993 | 461098942.429242
 ARGENTINA                 |   1992 | 464505965.122731
 BRAZIL                    |   1998 | 266217378.589549
 BRAZIL                    |   1997 | 464625842.276213
 BRAZIL                    |   1996 | 465493465.323193
 BRAZIL                    |   1995 | 460213670.220678
 BRAZIL                    |   1994 | 461442506.716517
 BRAZIL                    |   1993 | 455738129.850916
 BRAZIL                    |   1992 | 466813042.798505
 CANADA                    |   1998 | 278561170.965818
 CANADA                    |   1997 | 481758441.897041
 CANADA                    |   1996 | 486211855.818157
 CANADA                    |   1995 | 480620995.856035
 CANADA                    |   1994 | 484948435.393712
 CANADA                    |   1993 | 486922809.644292
 CANADA                    |   1992 | 489194759.063504
 CHINA                     |   1998 | 269774774.910474
 CHINA                     |   1997 | 444245140.583489
 CHINA                     |   1996 | 451448322.110807
 CHINA                     |   1995 | 448534955.442939
 CHINA                     |   1994 |  445486479.13936
 CHINA                     |   1993 | 454975378.338483
 CHINA                     |   1992 | 450676276.290771
 EGYPT                     |   1998 | 269237826.110265
 EGYPT                     |   1997 | 466429781.847102
 EGYPT                     |   1996 | 469182814.754081
 EGYPT                     |   1995 | 462342158.278764
 EGYPT                     |   1994 | 458354599.065633
 EGYPT                     |   1993 | 469919164.068827
 EGYPT                     |   1992 | 464584714.847565
 ETHIOPIA                  |   1998 | 264050962.797498
 ETHIOPIA                  |   1997 | 452628320.548971
 ETHIOPIA                  |   1996 | 456489819.370356
 ETHIOPIA                  |   1995 | 456430729.842765
 ETHIOPIA                  |   1994 | 453022690.619184
 ETHIOPIA                  |   1993 | 454720816.269522
 ETHIOPIA                  |   1992 | 460288565.314464
 FRANCE                    |   1998 | 267809225.889472
 FRANCE                    |   1997 |   459114634.3132
 FRANCE                    |   1996 | 464414048.787579
 FRANCE                    |   1995 | 460869565.330055
 FRANCE                    |   1994 |  456644995.53992
 FRANCE                    |   1993 | 462105435.854398
 FRANCE                    |   1992 | 456166844.260178
 GERMANY                   |   1998 | 276787432.933019
 GERMANY                   |   1997 | 474471422.194983
 GERMANY                   |   1996 | 478490228.543048
 GERMANY                   |   1995 |   476171407.9986
 GERMANY                   |   1994 |  473551734.56375
 GERMANY                   |   1993 |  471766935.55704
 GERMANY                   |   1992 | 469627352.574342
 INDIA                     |   1998 | 270169488.593405
 INDIA                     |   1997 | 471467145.363882
 INDIA                     |   1996 | 473692456.722076
 INDIA                     |   1995 | 468681278.378016
 INDIA                     |   1994 | 464244073.849331
 INDIA                     |   1993 |  463162172.20057
 INDIA                     |   1992 |  466032839.34416
 INDONESIA                 |   1998 | 271309085.503983
 INDONESIA                 |   1997 | 458537284.356223
 INDONESIA                 |   1996 | 462281572.150246
 INDONESIA                 |   1995 | 463745365.180864
 INDONESIA                 |   1994 |  461452008.82784
 INDONESIA                 |   1993 | 463869360.942868
 INDONESIA                 |   1992 | 465294057.679674
 IRAN                      |   1998 | 270067471.536988
 IRAN                      |   1997 |  460050113.49087
 IRAN                      |   1996 |  464769804.52276
 IRAN                      |   1995 | 461825835.825783
 IRAN                      |   1994 | 464854850.779995
 IRAN                      |   1993 | 467001083.362459
 IRAN                      |   1992 | 458811907.405502
 IRAQ                      |   1998 | 280594482.071342
 IRAQ                      |   1997 | 476558223.572897
 IRAQ                      |   1996 | 476563530.063688
 IRAQ                      |   1995 | 483560863.046405
 IRAQ                      |   1994 | 483598148.291941
 IRAQ                      |   1993 | 476437084.892724
 IRAQ                      |   1992 | 480189355.021654
 JAPAN                     |   1998 | 270858672.772564
 JAPAN                     |   1997 | 463664586.407102
 JAPAN                     |   1996 | 466346268.321027
 JAPAN                     |   1995 | 465356494.144586
 JAPAN                     |   1994 | 460153063.092014
 JAPAN                     |   1993 | 454258028.920139
 JAPAN                     |   1992 | 455790236.905277
 JORDAN                    |   1998 | 267441829.130822
 JORDAN                    |   1997 | 447156235.080641
 JORDAN                    |   1996 | 452642335.674334
 JORDAN                    |   1995 |  452015361.09659
 JORDAN                    |   1994 | 457534851.990027
 JORDAN                    |   1993 | 456135755.033254
 JORDAN                    |   1992 | 456713465.312739
 KENYA                     |   1998 | 272213973.317026
 KENYA                     |   1997 | 471729319.221191
 KENYA                     |   1996 | 470304832.553344
 KENYA                     |   1995 | 463406682.601859
 KENYA                     |   1994 | 471481871.437813
 KENYA                     |   1993 | 470927883.940206
 KENYA                     |   1992 | 467006018.367912
 MOROCCO                   |   1998 | 269935404.732999
 MOROCCO                   |   1997 |  466571670.35143
 MOROCCO                   |   1996 | 471503988.224955
 MOROCCO                   |   1995 | 467485869.015206
 MOROCCO                   |   1994 | 463600001.691797
 MOROCCO                   |   1993 | 459499316.655304
 MOROCCO                   |   1992 | 470547790.939142
 MOZAMBIQUE                |   1998 | 276401354.303688
 MOZAMBIQUE                |   1997 | 462828662.250963
 MOZAMBIQUE                |   1996 | 462290763.160779
 MOZAMBIQUE                |   1995 | 464999707.376191
 MOZAMBIQUE                |   1994 | 466128103.266555
 MOZAMBIQUE                |   1993 | 468403549.588024
 MOZAMBIQUE                |   1992 | 458251622.290287
 PERU                      |   1998 | 272358236.547435
 PERU                      |   1997 | 462247857.461729
 PERU                      |   1996 | 457282153.903895
 PERU                      |   1995 | 463552669.079187
 PERU                      |   1994 | 465072414.206519
 PERU                      |   1993 | 466828951.866066
 PERU                      |   1992 | 458853012.961207
 ROMANIA                   |   1998 | 271712534.310264
 ROMANIA                   |   1997 |  458714241.08017
 ROMANIA                   |   1996 | 455124892.596411
 ROMANIA                   |   1995 | 465346905.524817
 ROMANIA                   |   1994 | 466988228.752916
 ROMANIA                   |   1993 | 457613182.724125
 ROMANIA                   |   1992 | 469148470.602098
 RUSSIA                    |   1998 | 279621083.029827
 RUSSIA                    |   1997 | 475724754.275005
 RUSSIA                    |   1996 | 471133303.954315
 RUSSIA                    |   1995 | 470037087.150903
 RUSSIA                    |   1994 | 469717642.409916
 RUSSIA                    |   1993 | 473615986.287908
 RUSSIA                    |   1992 | 472893694.430111
 SAUDI ARABIA              |   1998 | 271272120.685713
 SAUDI ARABIA              |   1997 | 466820677.392516
 SAUDI ARABIA              |   1996 |  468953696.58901
 SAUDI ARABIA              |   1995 | 467188228.809342
 SAUDI ARABIA              |   1994 |  469246253.94364
 SAUDI ARABIA              |   1993 | 465425203.367849
 SAUDI ARABIA              |   1992 | 467943905.042571
 UNITED KINGDOM            |   1998 | 268733489.746868
 UNITED KINGDOM            |   1997 | 455385780.099619
 UNITED KINGDOM            |   1996 | 455856370.679468
 UNITED KINGDOM            |   1995 | 458535781.898373
 UNITED KINGDOM            |   1994 | 453575753.255796
 UNITED KINGDOM            |   1993 | 458208957.454244
 UNITED KINGDOM            |   1992 | 461280125.952897
 UNITED STATES             |   1998 | 282150796.335855
 UNITED STATES             |   1997 | 473304587.463723
 UNITED STATES             |   1996 | 482136427.917945
 UNITED STATES             |   1995 | 476780210.356046
 UNITED STATES             |   1994 | 473357488.039699
 UNITED STATES             |   1993 | 475285773.911351
 UNITED STATES             |   1992 | 488672982.662053
 VIETNAM                   |   1998 |  271134217.70382
 VIETNAM                   |   1997 | 464261483.585859
 VIETNAM                   |   1996 | 475948686.908864
 VIETNAM                   |   1995 | 466586085.761868
 VIETNAM                   |   1994 | 466873312.013971
 VIETNAM                   |   1993 | 473557741.784266
 VIETNAM                   |   1992 | 465029691.700026
(175 rows)

COMMIT;
COMMIT
