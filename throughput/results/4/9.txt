BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%salmon%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 270322543.810976
 ALGERIA                   |   1997 | 457589388.121602
 ALGERIA                   |   1996 | 464215284.693485
 ALGERIA                   |   1995 | 460541688.967314
 ALGERIA                   |   1994 | 458789416.008069
 ALGERIA                   |   1993 | 456846902.779998
 ALGERIA                   |   1992 | 455209095.520503
 ARGENTINA                 |   1998 | 270430961.693922
 ARGENTINA                 |   1997 | 454168482.275134
 ARGENTINA                 |   1996 | 461760366.337916
 ARGENTINA                 |   1995 | 461296186.103665
 ARGENTINA                 |   1994 | 466452665.452562
 ARGENTINA                 |   1993 | 455396098.984415
 ARGENTINA                 |   1992 | 462607297.621744
 BRAZIL                    |   1998 | 268080328.143751
 BRAZIL                    |   1997 | 456834611.612209
 BRAZIL                    |   1996 | 457069613.681853
 BRAZIL                    |   1995 | 472262291.514261
 BRAZIL                    |   1994 | 459213411.415152
 BRAZIL                    |   1993 | 457023041.168693
 BRAZIL                    |   1992 | 464100198.424093
 CANADA                    |   1998 | 279289953.332154
 CANADA                    |   1997 | 469908196.412152
 CANADA                    |   1996 | 475548566.153692
 CANADA                    |   1995 | 473466652.899643
 CANADA                    |   1994 | 473478903.027421
 CANADA                    |   1993 | 478219454.035554
 CANADA                    |   1992 |  473863369.47007
 CHINA                     |   1998 |  273803864.94418
 CHINA                     |   1997 |  464199069.90647
 CHINA                     |   1996 | 466500039.002175
 CHINA                     |   1995 | 461016110.759232
 CHINA                     |   1994 | 472984399.507255
 CHINA                     |   1993 | 466308289.399448
 CHINA                     |   1992 | 463348513.676717
 EGYPT                     |   1998 | 281347207.770664
 EGYPT                     |   1997 | 473591864.423142
 EGYPT                     |   1996 | 472775394.080733
 EGYPT                     |   1995 |  468773069.69142
 EGYPT                     |   1994 | 468746674.255703
 EGYPT                     |   1993 | 475703409.249214
 EGYPT                     |   1992 | 468317901.516814
 ETHIOPIA                  |   1998 | 262462243.952701
 ETHIOPIA                  |   1997 | 445183907.201761
 ETHIOPIA                  |   1996 | 447198830.990325
 ETHIOPIA                  |   1995 | 445880661.711459
 ETHIOPIA                  |   1994 | 443118033.598031
 ETHIOPIA                  |   1993 | 446340641.616066
 ETHIOPIA                  |   1992 | 448077490.937129
 FRANCE                    |   1998 | 267697745.783771
 FRANCE                    |   1997 | 459302638.162854
 FRANCE                    |   1996 | 462636907.823968
 FRANCE                    |   1995 | 454864272.927661
 FRANCE                    |   1994 | 461508352.177265
 FRANCE                    |   1993 | 461709120.534077
 FRANCE                    |   1992 | 459293452.655821
 GERMANY                   |   1998 | 272914048.162187
 GERMANY                   |   1997 |  476518896.67709
 GERMANY                   |   1996 | 480024863.855317
 GERMANY                   |   1995 | 471911140.396608
 GERMANY                   |   1994 | 479393662.995918
 GERMANY                   |   1993 | 476282197.151461
 GERMANY                   |   1992 | 479415325.720511
 INDIA                     |   1998 | 267412939.215787
 INDIA                     |   1997 |  473460228.62809
 INDIA                     |   1996 | 471174126.928943
 INDIA                     |   1995 | 470187001.233464
 INDIA                     |   1994 |  464461159.33255
 INDIA                     |   1993 | 473337891.741775
 INDIA                     |   1992 | 477232552.284512
 INDONESIA                 |   1998 | 269685585.985744
 INDONESIA                 |   1997 |  463770622.62624
 INDONESIA                 |   1996 | 461781890.566454
 INDONESIA                 |   1995 | 456165722.967812
 INDONESIA                 |   1994 | 455966381.105993
 INDONESIA                 |   1993 | 463393068.708347
 INDONESIA                 |   1992 |  463402698.26153
 IRAN                      |   1998 | 270189466.109472
 IRAN                      |   1997 | 468350685.932792
 IRAN                      |   1996 | 456568240.224367
 IRAN                      |   1995 | 462593787.044543
 IRAN                      |   1994 | 458100394.657172
 IRAN                      |   1993 | 465101052.283101
 IRAN                      |   1992 | 464276659.544757
 IRAQ                      |   1998 | 279109763.193332
 IRAQ                      |   1997 | 466776955.266506
 IRAQ                      |   1996 | 480188820.425103
 IRAQ                      |   1995 | 476047645.688626
 IRAQ                      |   1994 | 478885621.698944
 IRAQ                      |   1993 | 476963311.697851
 IRAQ                      |   1992 | 465615124.892102
 JAPAN                     |   1998 | 265405675.054154
 JAPAN                     |   1997 | 466458998.526906
 JAPAN                     |   1996 | 470532634.830808
 JAPAN                     |   1995 | 465878357.897502
 JAPAN                     |   1994 | 455368383.053504
 JAPAN                     |   1993 | 463637760.047444
 JAPAN                     |   1992 | 461280664.120787
 JORDAN                    |   1998 | 268262149.612179
 JORDAN                    |   1997 |  453949443.80195
 JORDAN                    |   1996 |  454410149.22237
 JORDAN                    |   1995 | 459290576.416787
 JORDAN                    |   1994 | 455827580.358896
 JORDAN                    |   1993 | 451643044.849805
 JORDAN                    |   1992 | 457545453.109865
 KENYA                     |   1998 | 269302195.916034
 KENYA                     |   1997 | 471779444.380125
 KENYA                     |   1996 | 461738691.992558
 KENYA                     |   1995 | 472968511.757195
 KENYA                     |   1994 |  469315316.49008
 KENYA                     |   1993 | 466804837.129808
 KENYA                     |   1992 | 464842848.040241
 MOROCCO                   |   1998 | 270176337.489546
 MOROCCO                   |   1997 | 463559640.373848
 MOROCCO                   |   1996 | 467043014.588967
 MOROCCO                   |   1995 | 465437505.319842
 MOROCCO                   |   1994 | 470312158.812993
 MOROCCO                   |   1993 | 463805909.024858
 MOROCCO                   |   1992 | 463565605.916545
 MOZAMBIQUE                |   1998 | 274070905.819415
 MOZAMBIQUE                |   1997 | 463021772.337448
 MOZAMBIQUE                |   1996 | 465758248.039458
 MOZAMBIQUE                |   1995 | 456739012.613354
 MOZAMBIQUE                |   1994 | 456160646.495638
 MOZAMBIQUE                |   1993 | 462947779.703266
 MOZAMBIQUE                |   1992 | 459320539.249263
 PERU                      |   1998 | 267515507.278667
 PERU                      |   1997 | 463656764.313261
 PERU                      |   1996 | 457534546.610414
 PERU                      |   1995 |  458974513.70753
 PERU                      |   1994 | 454458221.672229
 PERU                      |   1993 | 458921095.077477
 PERU                      |   1992 | 456837407.862921
 ROMANIA                   |   1998 |  273776511.12865
 ROMANIA                   |   1997 | 462542578.221208
 ROMANIA                   |   1996 | 471568994.269052
 ROMANIA                   |   1995 | 463121542.804848
 ROMANIA                   |   1994 | 461452722.463355
 ROMANIA                   |   1993 |  461860486.73404
 ROMANIA                   |   1992 | 458564106.735806
 RUSSIA                    |   1998 | 279834060.530173
 RUSSIA                    |   1997 | 467264585.373274
 RUSSIA                    |   1996 | 472821931.818251
 RUSSIA                    |   1995 |  469751981.30163
 RUSSIA                    |   1994 |  471198134.86874
 RUSSIA                    |   1993 | 470558094.285537
 RUSSIA                    |   1992 | 475427041.556449
 SAUDI ARABIA              |   1998 | 275267346.518793
 SAUDI ARABIA              |   1997 | 457410510.926938
 SAUDI ARABIA              |   1996 | 459327451.963193
 SAUDI ARABIA              |   1995 | 453841807.727881
 SAUDI ARABIA              |   1994 | 458737042.704636
 SAUDI ARABIA              |   1993 | 464019090.614679
 SAUDI ARABIA              |   1992 | 465987548.645908
 UNITED KINGDOM            |   1998 | 262435893.598192
 UNITED KINGDOM            |   1997 | 455938430.285526
 UNITED KINGDOM            |   1996 | 458138013.114738
 UNITED KINGDOM            |   1995 | 458759549.874123
 UNITED KINGDOM            |   1994 | 446406481.501423
 UNITED KINGDOM            |   1993 | 456392021.904981
 UNITED KINGDOM            |   1992 | 452630744.771908
 UNITED STATES             |   1998 | 279229688.542345
 UNITED STATES             |   1997 | 471573076.714471
 UNITED STATES             |   1996 |  471219609.88326
 UNITED STATES             |   1995 | 467223073.462974
 UNITED STATES             |   1994 | 472732901.171885
 UNITED STATES             |   1993 | 473521638.939854
 UNITED STATES             |   1992 | 464740429.284721
 VIETNAM                   |   1998 | 266061443.524914
 VIETNAM                   |   1997 |  462758359.21244
 VIETNAM                   |   1996 | 463918869.773969
 VIETNAM                   |   1995 | 464456002.484693
 VIETNAM                   |   1994 |  469441364.54793
 VIETNAM                   |   1993 | 469489087.812747
 VIETNAM                   |   1992 |  471828304.54858
(175 rows)

COMMIT;
COMMIT
