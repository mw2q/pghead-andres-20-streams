BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%goldenrod%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 265659406.241578
 ALGERIA                   |   1997 | 454946692.934672
 ALGERIA                   |   1996 | 456849416.241071
 ALGERIA                   |   1995 | 456391982.713221
 ALGERIA                   |   1994 | 451633170.147935
 ALGERIA                   |   1993 | 455721021.842539
 ALGERIA                   |   1992 | 448728171.530408
 ARGENTINA                 |   1998 | 270002181.735176
 ARGENTINA                 |   1997 | 461548043.974005
 ARGENTINA                 |   1996 | 466673724.118821
 ARGENTINA                 |   1995 | 468333209.496746
 ARGENTINA                 |   1994 | 465510467.683131
 ARGENTINA                 |   1993 | 461764989.407495
 ARGENTINA                 |   1992 | 464150660.686471
 BRAZIL                    |   1998 |   274745705.5666
 BRAZIL                    |   1997 | 466992538.048841
 BRAZIL                    |   1996 | 475122851.468075
 BRAZIL                    |   1995 | 464990333.569835
 BRAZIL                    |   1994 | 467554586.380924
 BRAZIL                    |   1993 | 469393074.922803
 BRAZIL                    |   1992 | 472566311.093533
 CANADA                    |   1998 | 267779984.053228
 CANADA                    |   1997 | 468316001.605328
 CANADA                    |   1996 |  474969534.50658
 CANADA                    |   1995 | 465034265.185448
 CANADA                    |   1994 | 472442487.187271
 CANADA                    |   1993 | 470264570.930089
 CANADA                    |   1992 | 461141193.434928
 CHINA                     |   1998 | 274627649.089117
 CHINA                     |   1997 | 460935751.135872
 CHINA                     |   1996 | 462622133.246189
 CHINA                     |   1995 |  461499261.27098
 CHINA                     |   1994 | 463853786.573052
 CHINA                     |   1993 | 456981407.698583
 CHINA                     |   1992 | 464544729.644971
 EGYPT                     |   1998 | 266698406.645411
 EGYPT                     |   1997 | 463941559.885433
 EGYPT                     |   1996 | 460358585.423076
 EGYPT                     |   1995 |  454744537.21544
 EGYPT                     |   1994 | 452952117.979514
 EGYPT                     |   1993 | 461393537.018732
 EGYPT                     |   1992 | 452895319.063413
 ETHIOPIA                  |   1998 | 264867670.659492
 ETHIOPIA                  |   1997 |  447053750.85784
 ETHIOPIA                  |   1996 | 458268542.723088
 ETHIOPIA                  |   1995 | 450235757.859331
 ETHIOPIA                  |   1994 | 456801006.437006
 ETHIOPIA                  |   1993 | 459443746.420773
 ETHIOPIA                  |   1992 |  461829684.79148
 FRANCE                    |   1998 | 270247840.426508
 FRANCE                    |   1997 | 454794981.463721
 FRANCE                    |   1996 | 460845117.660778
 FRANCE                    |   1995 | 451345172.960583
 FRANCE                    |   1994 | 456946007.289314
 FRANCE                    |   1993 | 455821078.083736
 FRANCE                    |   1992 | 457526636.846396
 GERMANY                   |   1998 | 275726933.984234
 GERMANY                   |   1997 | 468420341.937602
 GERMANY                   |   1996 | 473670469.963505
 GERMANY                   |   1995 | 468772431.144662
 GERMANY                   |   1994 | 474121603.833231
 GERMANY                   |   1993 | 481189265.598543
 GERMANY                   |   1992 | 473262940.432738
 INDIA                     |   1998 |  269954356.96596
 INDIA                     |   1997 | 466848445.633122
 INDIA                     |   1996 | 465609655.777053
 INDIA                     |   1995 | 470649188.798272
 INDIA                     |   1994 | 466032669.278344
 INDIA                     |   1993 | 471277873.169599
 INDIA                     |   1992 | 468613443.243854
 INDONESIA                 |   1998 | 269770043.978982
 INDONESIA                 |   1997 | 454339014.268064
 INDONESIA                 |   1996 | 456072416.125795
 INDONESIA                 |   1995 | 454114982.118869
 INDONESIA                 |   1994 | 452031827.400587
 INDONESIA                 |   1993 | 457084906.090236
 INDONESIA                 |   1992 | 462638006.776629
 IRAN                      |   1998 | 275291401.397516
 IRAN                      |   1997 | 469427614.393901
 IRAN                      |   1996 | 471730330.778381
 IRAN                      |   1995 | 468725932.758957
 IRAN                      |   1994 | 464822024.959821
 IRAN                      |   1993 | 465913604.616575
 IRAN                      |   1992 |  469297292.22827
 IRAQ                      |   1998 |  276347158.62672
 IRAQ                      |   1997 |  471224753.42529
 IRAQ                      |   1996 | 485755763.995989
 IRAQ                      |   1995 |   469066871.8323
 IRAQ                      |   1994 | 475426432.160265
 IRAQ                      |   1993 | 477295044.550394
 IRAQ                      |   1992 | 479555112.656922
 JAPAN                     |   1998 | 272514777.826183
 JAPAN                     |   1997 |   467122591.1138
 JAPAN                     |   1996 | 460167877.554791
 JAPAN                     |   1995 | 461103791.705032
 JAPAN                     |   1994 | 462702497.621466
 JAPAN                     |   1993 | 467346499.844631
 JAPAN                     |   1992 |  453684867.40761
 JORDAN                    |   1998 | 268299235.378583
 JORDAN                    |   1997 | 443920895.517988
 JORDAN                    |   1996 |  449520088.29992
 JORDAN                    |   1995 | 443460462.930596
 JORDAN                    |   1994 | 458815522.464533
 JORDAN                    |   1993 | 459269908.459922
 JORDAN                    |   1992 | 448929507.040136
 KENYA                     |   1998 | 272633077.753601
 KENYA                     |   1997 | 467365491.684524
 KENYA                     |   1996 | 466518067.654885
 KENYA                     |   1995 | 466883987.973455
 KENYA                     |   1994 | 471086659.839261
 KENYA                     |   1993 |  474995320.71085
 KENYA                     |   1992 | 473685132.996764
 MOROCCO                   |   1998 |  273043930.32977
 MOROCCO                   |   1997 |  461777516.16433
 MOROCCO                   |   1996 | 470672297.909107
 MOROCCO                   |   1995 | 466904789.011537
 MOROCCO                   |   1994 | 464381967.377832
 MOROCCO                   |   1993 | 467733866.955257
 MOROCCO                   |   1992 | 463345477.622161
 MOZAMBIQUE                |   1998 | 270610573.328259
 MOZAMBIQUE                |   1997 | 452531209.154613
 MOZAMBIQUE                |   1996 | 450335933.995509
 MOZAMBIQUE                |   1995 | 457901316.627088
 MOZAMBIQUE                |   1994 | 461186924.328783
 MOZAMBIQUE                |   1993 | 454895842.648488
 MOZAMBIQUE                |   1992 | 457491161.102782
 PERU                      |   1998 | 276470849.968146
 PERU                      |   1997 | 457853284.749072
 PERU                      |   1996 | 463068246.134382
 PERU                      |   1995 | 466332329.444614
 PERU                      |   1994 | 456028711.200262
 PERU                      |   1993 | 462373788.707974
 PERU                      |   1992 | 469569725.994124
 ROMANIA                   |   1998 | 274633765.104744
 ROMANIA                   |   1997 | 460068925.282968
 ROMANIA                   |   1996 | 464987657.890062
 ROMANIA                   |   1995 |  448846344.63453
 ROMANIA                   |   1994 | 457128819.626889
 ROMANIA                   |   1993 | 462722395.230703
 ROMANIA                   |   1992 | 472680808.015656
 RUSSIA                    |   1998 |  270730508.28292
 RUSSIA                    |   1997 | 461010999.369427
 RUSSIA                    |   1996 | 465087456.622763
 RUSSIA                    |   1995 | 462773383.277662
 RUSSIA                    |   1994 | 451207474.071846
 RUSSIA                    |   1993 | 459948209.487954
 RUSSIA                    |   1992 | 471434213.889071
 SAUDI ARABIA              |   1998 | 272852998.079517
 SAUDI ARABIA              |   1997 | 463694903.257627
 SAUDI ARABIA              |   1996 | 460950314.269653
 SAUDI ARABIA              |   1995 | 464901539.935427
 SAUDI ARABIA              |   1994 | 464116461.837095
 SAUDI ARABIA              |   1993 | 458059669.816583
 SAUDI ARABIA              |   1992 | 457579523.155015
 UNITED KINGDOM            |   1998 | 267115271.084597
 UNITED KINGDOM            |   1997 |  462353778.76453
 UNITED KINGDOM            |   1996 | 458874284.530637
 UNITED KINGDOM            |   1995 | 454284326.413249
 UNITED KINGDOM            |   1994 | 463946700.690066
 UNITED KINGDOM            |   1993 | 466296611.904372
 UNITED KINGDOM            |   1992 | 459971806.690872
 UNITED STATES             |   1998 | 272152651.522778
 UNITED STATES             |   1997 |   475051954.3061
 UNITED STATES             |   1996 | 470196529.075494
 UNITED STATES             |   1995 | 469965859.719204
 UNITED STATES             |   1994 | 472876527.603202
 UNITED STATES             |   1993 | 463916627.245701
 UNITED STATES             |   1992 | 469987566.535147
 VIETNAM                   |   1998 | 271641205.719818
 VIETNAM                   |   1997 | 463232951.047742
 VIETNAM                   |   1996 | 472134819.804447
 VIETNAM                   |   1995 |   461127958.5378
 VIETNAM                   |   1994 | 466287752.183468
 VIETNAM                   |   1993 | 470196157.604835
 VIETNAM                   |   1992 | 467415166.439926
(175 rows)

COMMIT;
COMMIT
